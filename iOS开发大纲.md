# 🎨 GenerateIcon iOS 开发大纲

## 📱 项目概述

基于Web版本的图标生成器，开发iOS原生应用，提供更流畅的移动端体验和iOS特有的功能。

## 🎯 核心功能

### 1. 图标生成功能
- **预设图标类型**：
  - 🧮 计算器图标
  - 🖱️ 鼠标图标  
  - ⌨️ 键盘图标
  - 🖥️ 显示器图标
  - 📍 定位图标
  - 📄 文档图标
  - 📁 文件夹图标
  - 🖨️ 打印机图标
  - 📅 日历图标
  - 📞 电话图标
  - 📧 邮件图标
  - 💬 消息图标
  - 📹 视频通话图标
  - 🎵 音乐图标
  - 📷 相机图标
  - 🖼️ 相册图标
  - ▶️ 视频播放器图标
  - ⚙️ 设置图标
  - 🔍 搜索图标
  - ❤️ 收藏图标
  - ⭐ 评分图标
  - 🎨 AI生成图标

### 2. 自定义设置
- **底图样式设置**：
  - 形状选择（圆形/圆角矩形/方形）
  - 背景颜色配置
  - 圆角半径调整
  - 图标内边距设置
  - 阴影强度控制
  - 边框宽度和颜色

- **外框设置**：
  - 外框背景色
  - 外框边框宽度
  - 外框内边距

### 3. AI生成功能
- **文本描述输入**：支持中文和英文描述
- **样式选择**：字体大小、字体族、文字样式
- **颜色配置**：文字颜色自定义
- **长度限制**：最大字符数控制
- **文本换行**：支持多行文本

### 4. 输出功能
- **单图标生成**：自定义尺寸（24px-1024px）
- **iOS图标集**：完整的iOS应用图标集
- **相册保存**：直接保存到系统相册
- **文件分享**：支持AirDrop、邮件等分享方式

## 🏗️ 技术架构

### 1. 架构模式
- **MVVM架构**：Model-View-ViewModel
- **SwiftUI**：声明式UI框架
- **Combine**：响应式编程框架

### 2. 核心组件
- **IconGeneratorService**：图标生成服务
- **FileManagerService**：文件管理服务
- **SettingsService**：设置存储服务
- **IconGeneratorViewModel**：主视图模型
- **各种IconGenerator**：具体图标生成器
  - 规则：ViewA（外框基底）/ ViewB（容器背景：圆角、背景色、边框、阴影、内边距）/ ViewC（图标Image）
  - 预设模式：仅替换 ViewC（预设图）
  - AI模式：生成“透明背景文字图”作为 ViewC；背景效果由 ViewB 负责

### 3. 数据模型
- **IconType**：图标类型枚举
- **IconSettings**：图标设置数据模型
- **AISettings**：AI设置数据模型
- **ColorData**：颜色数据包装器

## 📱 界面设计

### 1. 主界面布局
- **导航栏**：标题 + 设置按钮
- **左侧面板**（iPad）：图标类型选择器
- **中央区域**：图标预览 + 生成按钮
- **右侧面板**（iPad）：设置面板

### 2. 响应式设计
- **iPhone**：垂直布局，模态弹窗
- **iPad**：水平布局，侧边面板
- **自适应**：根据屏幕尺寸调整布局

### 3. 交互设计
- **图标选择**：分类浏览 + 网格布局
- **设置调整**：实时预览 + 滑块控制
- **生成流程**：进度显示 + 状态反馈
 - **预览统一与刷新**：
   - 首页与设置页通过 IconPreviewComponent 渲染，统一 IconPreviewConfig
   - 设置变更触发 NotificationCenter(.settingsDidChange) → 各预览 loadPreview()
   - 预览任务增加竞态防护，只在 iconType 未变化时应用结果

## 🔧 开发状态

### ✅ 已完成功能
- [x] 基础图标生成器
- [x] 多种图标类型支持（25+种图标类型）
- [x] 自定义设置面板
- [x] AI图标生成
- [x] iOS图标集生成
- [x] 相册保存功能
- [x] 响应式界面设计
- [x] 图标切换优化
- [x] 自动滚动功能
- [x] 分辨率适配
- [x] 文档类图标区分
- [x] HUD和Toast集成
- [x] 用户反馈系统
- [x] 预览统一、AI文字透明、通知刷新、竞态防护
- [x] 编译错误修复

### 🚧 待实现功能
- [ ] 图标模板库
- [ ] 批量处理功能
- [ ] 云端同步
- [ ] 更多AI模型
- [ ] 图标历史记录
- [ ] 模板库与收藏夹
- [ ] 预览降噪（去抖/合并）策略
- [ ] 用户偏好设置
- [ ] 图标导入功能
- [ ] 高级编辑功能

### 🔄 优化计划
- [ ] 性能优化
- [ ] 内存管理
- [ ] 错误处理完善
- [ ] 用户体验提升
- [ ] 代码重构

## 📊 项目结构

```
GenerateIcon/
├── Core/
│   ├── Models/
│   │   ├── IconSettings.swift
│   │   └── IconType.swift
│   └── Services/
│       ├── FileManagerService.swift
│       └── IconGeneratorService.swift
├── Features/
│   ├── AIGeneration/
│   │   └── Views/
│   │       └── AIGeneratorView.swift
│   └── IconGeneration/
│       ├── ViewModels/
│       │   └── IconGeneratorViewModel.swift
│       └── Views/
│           ├── IconGeneratorView.swift
│           ├── IconSelectorView.swift
│           ├── SettingsPanelView.swift
│           └── SizeSelectionView.swift
├── Generators/
│   ├── AI/
│   ├── Calculator/
│   ├── Communication/
│   ├── Document/
│   ├── Keyboard/
│   ├── Location/
│   ├── Media/
│   ├── Monitor/
│   ├── Mouse/
│   └── Tools/
└── Assets.xcassets/
```

## 🎯 开发目标

### 短期目标（1-2周）
- [ ] 完善现有功能
- [ ] 优化用户体验
- [ ] 修复已知问题
- [ ] 添加单元测试

### 中期目标（1个月）
- [ ] 添加图标模板库
- [ ] 实现批量处理
- [ ] 优化AI生成质量
- [ ] 添加用户反馈

### 长期目标（3个月）
- [ ] 云端同步功能
- [ ] 更多AI模型支持
- [ ] 高级编辑功能
- [ ] 社区功能

## 📈 技术指标

- **代码覆盖率**：目标 > 80%
- **性能指标**：图标生成 < 2秒
- **内存使用**：< 100MB
- **应用大小**：< 50MB
- **启动时间**：< 3秒

## 🔍 质量保证

- **代码审查**：所有代码提交前审查
- **单元测试**：核心功能100%覆盖
- **集成测试**：端到端测试
- **性能测试**：内存和CPU使用监控
- **用户体验测试**：真实用户反馈